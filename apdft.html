

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Implementation &mdash; APDFT  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Features and supported software" href="features.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> APDFT
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">APDFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Features and supported software</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html#adding-support-for-additional-software-packages">Adding support for additional software packages</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Implementation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#energies">Energies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#density-moments">Density Moments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ionic-forces">Ionic Forces</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-apdft.calculator">Calculators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-apdft.calculator.gaussian">Gaussian</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-apdft.calculator.gaussian">MRCC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-apdft.Derivatives">Derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-apdft.physics">Physics-related functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-apdft.math">Math-related functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-apdft">APDFT logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-apdft.commandline">Command Line Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-apdft.settings">Settings</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">APDFT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Implementation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/apdft.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="implementation">
<h1>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h1>
<p>In the context of APDFT, we evaluate energy differences by</p>
<div class="math notranslate nohighlight">
\[\Delta E = \int_\Omega d\mathbf{r} \Delta V(\mathbf{r})\tilde\rho(\mathbf{r})\]</div>
<p>where <span class="math notranslate nohighlight">\(\tilde\rho\)</span> is obtained by means of finite difference evaluations and the change in external potential <span class="math notranslate nohighlight">\(\Delta V\)</span> is given by the Coulomb term</p>
<div class="math notranslate nohighlight">
\[\Delta V(\mathbf{r}) = \sum_I \frac{\Delta Z_I}{|\mathbf{r} - \mathbf{R_I}|} = \sum_I  \Delta V_I(\mathbf{r})\]</div>
<p>running over all nuclei <span class="math notranslate nohighlight">\(I\)</span>. <span class="math notranslate nohighlight">\(\tilde\rho\)</span> in fact is a linear combination of individual electron densities for fractional nuclear charges, so we can write is as follows</p>
<div class="math notranslate nohighlight">
\[\tilde\rho(\mathbf{r}) = \sum_i \alpha_i\rho_i(\mathbf{r})\]</div>
<p>where the coefficients <span class="math notranslate nohighlight">\(\alpha_i\)</span> are determined by the finite difference scheme employed.</p>
<div class="section" id="energies">
<h2>Energies<a class="headerlink" href="#energies" title="Permalink to this headline">¶</a></h2>
<p>Together with the above equations for <span class="math notranslate nohighlight">\(\Delta V_I\)</span>, the expression for the change in energy can be re-cast</p>
<div class="math notranslate nohighlight">
\[\begin{split}\Delta E &amp;= \int_\Omega d\mathbf{r} \left(\sum_I \frac{\Delta Z_I}{|\mathbf{r} - \mathbf{R_I}|}\right) \left(\sum_i \alpha_i\rho_i(\mathbf{r})\right) \\
         &amp;= \sum_I\sum_i \Delta Z_I\alpha_i \int_\Omega d\mathbf{r} \frac{\rho_i(\mathbf{r})}{|\mathbf{r} - \mathbf{R_I}|}\end{split}\]</div>
<p>which is much more efficient to implement, since the (costly) evaluation of the integral in space only needs to be done once for every combination of density <span class="math notranslate nohighlight">\(\rho_i\)</span> and nucleus <span class="math notranslate nohighlight">\(I\)</span>. The latter term corresponds to the electrostatic potential at the nucleus (EPN) which can be calculated analytically in many codes (e.g. psi4).</p>
<p>This can be further simplified as an outer product, i.e. <span class="math notranslate nohighlight">\(\mathbf{\Delta Z}=\{\Delta Z_I\}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\Delta E = \sum_{jk} \left(\left[\mathbf{\Delta Z}\otimes \mathbf{\alpha}\right]\circ \mathbf{Q}\right)_{jk}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{Q}_{Ii}\)</span> is just the electrostatic potential of density <span class="math notranslate nohighlight">\(i\)</span> at nucleus <span class="math notranslate nohighlight">\(I\)</span>. This formulation is numerically efficient to implement, since it only requires the QM codes to export <span class="math notranslate nohighlight">\(\mathbf{Q}\)</span> instead of an explicit density grid. Moreover, since the density matrix does not need to be exported, interfacing is more reliable because no basis function ordering is relevant to the results.</p>
</div>
<div class="section" id="density-moments">
<h2>Density Moments<a class="headerlink" href="#density-moments" title="Permalink to this headline">¶</a></h2>
<p>The electronic component of the charge distribution moments can be obtained from a linear combination of the same quantities evaluated for the individual single point calculations from the finite difference scheme. For example, for the dipole moment, we have</p>
<div class="math notranslate nohighlight">
\[\mu_i = \int_\Omega d\mathbf{r} \rho(\mathbf{r})\mathbf{r}_i\]</div>
<p>Similarly to the energy, the target density <span class="math notranslate nohighlight">\(\rho_t\)</span> can be build from coefficients of the individual calculations in the context of the finite difference scheme. Note that these coefficients <span class="math notranslate nohighlight">\(\beta_i\)</span> are not the same as for the energy expression.</p>
<div class="math notranslate nohighlight">
\[\rho_t(\mathbf{r}) = \sum_i \beta_i\rho_i(\mathbf{r})\]</div>
<p>For the dipole moment, this results in a linear combination of the dipole moments of the individual single point calculations</p>
<div class="math notranslate nohighlight">
\[\mu_i = \sum_i \beta_i \int_\Omega d\mathbf{r} \rho_i(\mathbf{r}) \mathbf{r}_i\]</div>
<p>Note that this only applies to the electronic component of the charge distribution moments.</p>
</div>
<div class="section" id="ionic-forces">
<h2>Ionic Forces<a class="headerlink" href="#ionic-forces" title="Permalink to this headline">¶</a></h2>
<p>Similarly to dipole moments, the expression for the ionic force allows linear combinations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{F}_I &amp;= Z_I\int_\Omega d\mathbf{r} \rho_t(\mathbf{r})\frac{\mathbf{r} - \mathbf{R}_I}{|\mathbf{r} - \mathbf{R}_I|^3}\\
            &amp;=Z_I\sum_i \beta_i\int_\Omega d\mathbf{r} \rho_i(\mathbf{r})\frac{\mathbf{r} - \mathbf{R}_I}{|\mathbf{r} - \mathbf{R}_I|^3}\\\end{split}\]</div>
</div>
<div class="section" id="module-apdft.calculator">
<span id="calculators"></span><h2>Calculators<a class="headerlink" href="#module-apdft.calculator" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="apdft.calculator.Calculator">
<em class="property">class </em><code class="sig-prename descclassname">apdft.calculator.</code><code class="sig-name descname">Calculator</code><span class="sig-paren">(</span><em class="sig-param">method</em>, <em class="sig-param">basisset</em>, <em class="sig-param">superimpose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator.html#Calculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.calculator.Calculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A concurrency-safe blocking interface for an external QM code.</p>
<dl class="method">
<dt id="apdft.calculator.Calculator.get_density_on_grid">
<code class="sig-name descname">get_density_on_grid</code><span class="sig-paren">(</span><em class="sig-param">folder</em>, <em class="sig-param">gridpoints</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator.html#Calculator.get_density_on_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.calculator.Calculator.get_density_on_grid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="apdft.calculator.Calculator.get_grid">
<em class="property">static </em><code class="sig-name descname">get_grid</code><span class="sig-paren">(</span><em class="sig-param">nuclear_numbers</em>, <em class="sig-param">coordinates</em>, <em class="sig-param">outputfolder</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator.html#Calculator.get_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.calculator.Calculator.get_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the integration grid used by this calculator for a given set of nuclei and geometry.</p>
<p>Grid weights and coordinates may be in internal units. Return value should be coords, weights. If return value is None, a default grid is used.</p>
</dd></dl>

<dl class="method">
<dt id="apdft.calculator.Calculator.get_methods">
<code class="sig-name descname">get_methods</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator.html#Calculator.get_methods"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.calculator.Calculator.get_methods" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="apdft.calculator.MockCalculator">
<em class="property">class </em><code class="sig-prename descclassname">apdft.calculator.</code><code class="sig-name descname">MockCalculator</code><span class="sig-paren">(</span><em class="sig-param">method</em>, <em class="sig-param">basisset</em>, <em class="sig-param">superimpose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator.html#MockCalculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.calculator.MockCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#apdft.calculator.Calculator" title="apdft.calculator.Calculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">apdft.calculator.Calculator</span></code></a></p>
<dl class="method">
<dt id="apdft.calculator.MockCalculator.get_runfile">
<em class="property">classmethod </em><code class="sig-name descname">get_runfile</code><span class="sig-paren">(</span><em class="sig-param">coordinates</em>, <em class="sig-param">nuclear_numbers</em>, <em class="sig-param">nuclear_charges</em>, <em class="sig-param">grid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator.html#MockCalculator.get_runfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.calculator.MockCalculator.get_runfile" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<div class="section" id="module-apdft.calculator.gaussian">
<span id="gaussian"></span><h3>Gaussian<a class="headerlink" href="#module-apdft.calculator.gaussian" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="apdft.calculator.gaussian.GaussianCalculator">
<em class="property">class </em><code class="sig-prename descclassname">apdft.calculator.gaussian.</code><code class="sig-name descname">GaussianCalculator</code><span class="sig-paren">(</span><em class="sig-param">method</em>, <em class="sig-param">basisset</em>, <em class="sig-param">superimpose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator/gaussian.html#GaussianCalculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.calculator.gaussian.GaussianCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#apdft.calculator.Calculator" title="apdft.calculator.Calculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">apdft.calculator.Calculator</span></code></a></p>
<dl class="method">
<dt id="apdft.calculator.gaussian.GaussianCalculator.density_on_grid">
<em class="property">static </em><code class="sig-name descname">density_on_grid</code><span class="sig-paren">(</span><em class="sig-param">inputfile</em>, <em class="sig-param">grid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator/gaussian.html#GaussianCalculator.density_on_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.calculator.gaussian.GaussianCalculator.density_on_grid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="apdft.calculator.gaussian.GaussianCalculator.get_density_on_grid">
<code class="sig-name descname">get_density_on_grid</code><span class="sig-paren">(</span><em class="sig-param">folder</em>, <em class="sig-param">gridpoints</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator/gaussian.html#GaussianCalculator.get_density_on_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.calculator.gaussian.GaussianCalculator.get_density_on_grid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="apdft.calculator.gaussian.GaussianCalculator.get_electronic_dipole">
<em class="property">static </em><code class="sig-name descname">get_electronic_dipole</code><span class="sig-paren">(</span><em class="sig-param">folder</em>, <em class="sig-param">gridcoords</em>, <em class="sig-param">gridweights</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator/gaussian.html#GaussianCalculator.get_electronic_dipole"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.calculator.gaussian.GaussianCalculator.get_electronic_dipole" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the electronic dipole moment.</p>
</dd></dl>

<dl class="method">
<dt id="apdft.calculator.gaussian.GaussianCalculator.get_input">
<code class="sig-name descname">get_input</code><span class="sig-paren">(</span><em class="sig-param">coordinates</em>, <em class="sig-param">nuclear_numbers</em>, <em class="sig-param">nuclear_charges</em>, <em class="sig-param">grid</em>, <em class="sig-param">iscomparison=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator/gaussian.html#GaussianCalculator.get_input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.calculator.gaussian.GaussianCalculator.get_input" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="apdft.calculator.gaussian.GaussianCalculator.get_runfile">
<em class="property">classmethod </em><code class="sig-name descname">get_runfile</code><span class="sig-paren">(</span><em class="sig-param">coordinates</em>, <em class="sig-param">nuclear_numbers</em>, <em class="sig-param">nuclear_charges</em>, <em class="sig-param">grid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator/gaussian.html#GaussianCalculator.get_runfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.calculator.gaussian.GaussianCalculator.get_runfile" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="apdft.calculator.gaussian.GaussianCalculator.get_total_energy">
<em class="property">static </em><code class="sig-name descname">get_total_energy</code><span class="sig-paren">(</span><em class="sig-param">folder</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator/gaussian.html#GaussianCalculator.get_total_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.calculator.gaussian.GaussianCalculator.get_total_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the total energy in Hartree.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-apdft.calculator.gaussian">
<span id="mrcc"></span><h3>MRCC<a class="headerlink" href="#module-apdft.calculator.gaussian" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">apdft.calculator.gaussian.</code><code class="sig-name descname">GaussianCalculator</code><span class="sig-paren">(</span><em class="sig-param">method</em>, <em class="sig-param">basisset</em>, <em class="sig-param">superimpose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator/gaussian.html#GaussianCalculator"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <a class="reference internal" href="#apdft.calculator.Calculator" title="apdft.calculator.Calculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">apdft.calculator.Calculator</span></code></a></p>
<dl class="method">
<dt>
<em class="property">static </em><code class="sig-name descname">density_on_grid</code><span class="sig-paren">(</span><em class="sig-param">inputfile</em>, <em class="sig-param">grid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator/gaussian.html#GaussianCalculator.density_on_grid"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">get_density_on_grid</code><span class="sig-paren">(</span><em class="sig-param">folder</em>, <em class="sig-param">gridpoints</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator/gaussian.html#GaussianCalculator.get_density_on_grid"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<em class="property">static </em><code class="sig-name descname">get_electronic_dipole</code><span class="sig-paren">(</span><em class="sig-param">folder</em>, <em class="sig-param">gridcoords</em>, <em class="sig-param">gridweights</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator/gaussian.html#GaussianCalculator.get_electronic_dipole"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns the electronic dipole moment.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">get_input</code><span class="sig-paren">(</span><em class="sig-param">coordinates</em>, <em class="sig-param">nuclear_numbers</em>, <em class="sig-param">nuclear_charges</em>, <em class="sig-param">grid</em>, <em class="sig-param">iscomparison=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator/gaussian.html#GaussianCalculator.get_input"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<em class="property">classmethod </em><code class="sig-name descname">get_runfile</code><span class="sig-paren">(</span><em class="sig-param">coordinates</em>, <em class="sig-param">nuclear_numbers</em>, <em class="sig-param">nuclear_charges</em>, <em class="sig-param">grid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator/gaussian.html#GaussianCalculator.get_runfile"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<em class="property">static </em><code class="sig-name descname">get_total_energy</code><span class="sig-paren">(</span><em class="sig-param">folder</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/calculator/gaussian.html#GaussianCalculator.get_total_energy"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns the total energy in Hartree.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-apdft.Derivatives">
<span id="derivatives"></span><h2>Derivatives<a class="headerlink" href="#module-apdft.Derivatives" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="apdft.Derivatives.DerivativeFolders">
<em class="property">class </em><code class="sig-prename descclassname">apdft.Derivatives.</code><code class="sig-name descname">DerivativeFolders</code><span class="sig-paren">(</span><em class="sig-param">highest_order</em>, <em class="sig-param">nuclear_numbers</em>, <em class="sig-param">coordinates</em>, <em class="sig-param">max_charge=0</em>, <em class="sig-param">max_deltaz=3</em>, <em class="sig-param">include_atoms=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/Derivatives.html#DerivativeFolders"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.Derivatives.DerivativeFolders" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#apdft.physics.APDFT" title="apdft.physics.APDFT"><code class="xref py py-class docutils literal notranslate"><span class="pre">apdft.physics.APDFT</span></code></a></p>
<dl class="method">
<dt id="apdft.Derivatives.DerivativeFolders.analyse">
<code class="sig-name descname">analyse</code><span class="sig-paren">(</span><em class="sig-param">explicit_reference=False</em>, <em class="sig-param">do_energies=True</em>, <em class="sig-param">do_dipoles=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/Derivatives.html#DerivativeFolders.analyse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.Derivatives.DerivativeFolders.analyse" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs actual analysis and integration. Prints results</p>
</dd></dl>

<dl class="method">
<dt id="apdft.Derivatives.DerivativeFolders.assign_calculator">
<code class="sig-name descname">assign_calculator</code><span class="sig-paren">(</span><em class="sig-param">calculator</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/Derivatives.html#DerivativeFolders.assign_calculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.Derivatives.DerivativeFolders.assign_calculator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="apdft.Derivatives.DerivativeFolders.get_density_derivative">
<code class="sig-name descname">get_density_derivative</code><span class="sig-paren">(</span><em class="sig-param">sites</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/Derivatives.html#DerivativeFolders.get_density_derivative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.Derivatives.DerivativeFolders.get_density_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the n-th order density derivative.</p>
<p>Heavy function, will be called often, caching needed.
The order of the derivative is implicitly known since it’s the length of <em>sites</em> argument via the chain rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sites</strong> – Integer list of sites that are perturbed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array of electron density at the grid coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="apdft.Derivatives.DerivativeFolders.get_density_from_reference">
<code class="sig-name descname">get_density_from_reference</code><span class="sig-paren">(</span><em class="sig-param">nuclear_charges</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/Derivatives.html#DerivativeFolders.get_density_from_reference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.Derivatives.DerivativeFolders.get_density_from_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>Retreives the density from a QM reference. Abstract function.</p>
<p>Light function, will not be called often, so no caching needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nuclear_charges</strong> – Integer list of nuclear charges. [e]</p></li>
<li><p><strong>gridcoords</strong> – Grid coordinates. [Angstrom]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array of electron density at the grid coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="apdft.Derivatives.DerivativeFolders.get_energy_from_reference">
<code class="sig-name descname">get_energy_from_reference</code><span class="sig-paren">(</span><em class="sig-param">nuclear_charges</em>, <em class="sig-param">is_reference_molecule=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/Derivatives.html#DerivativeFolders.get_energy_from_reference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.Derivatives.DerivativeFolders.get_energy_from_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>Retreives the total energy from a QM reference. Abstract function.</p>
<p>Light function, will not be called often, so no caching needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nuclear_charges</strong> – Integer list of nuclear charges. [e]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The total energy. [Hartree]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="apdft.Derivatives.DerivativeFolders.prepare">
<code class="sig-name descname">prepare</code><span class="sig-paren">(</span><em class="sig-param">explicit_reference=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/Derivatives.html#DerivativeFolders.prepare"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.Derivatives.DerivativeFolders.prepare" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a complete folder list of all relevant calculations.</p>
</dd></dl>

<dl class="method">
<dt id="apdft.Derivatives.DerivativeFolders.update_grid">
<code class="sig-name descname">update_grid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/Derivatives.html#DerivativeFolders.update_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.Derivatives.DerivativeFolders.update_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the integration grid from the calculator or provides a default one.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-apdft.physics">
<span id="physics-related-functions"></span><h2>Physics-related functions<a class="headerlink" href="#module-apdft.physics" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="apdft.physics.APDFT">
<em class="property">class </em><code class="sig-prename descclassname">apdft.physics.</code><code class="sig-name descname">APDFT</code><span class="sig-paren">(</span><em class="sig-param">highest_order</em>, <em class="sig-param">nuclear_numbers</em>, <em class="sig-param">coordinates</em>, <em class="sig-param">max_charge=0</em>, <em class="sig-param">max_deltaz=3</em>, <em class="sig-param">include_atoms=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/physics.html#APDFT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.physics.APDFT" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of alchemical perturbation density functional theory.</p>
<p>This is an abstract base class. This means that for any use, one needs to inherit from this class.
The subclass needs to implement all functions that raise a NotImplementedError upon invocation.</p>
<dl class="method">
<dt id="apdft.physics.APDFT.enumerate_all_targets">
<code class="sig-name descname">enumerate_all_targets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/physics.html#APDFT.enumerate_all_targets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.physics.APDFT.enumerate_all_targets" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a list of all possible targets.</p>
<p>Note that the order is not guaranteed to be stable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>self</strong> – Class instance from which the total charge and number of sites is determined.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of lists with the integer nuclear charges.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="apdft.physics.APDFT.estimate_cost_and_coverage">
<code class="sig-name descname">estimate_cost_and_coverage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/physics.html#APDFT.estimate_cost_and_coverage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.physics.APDFT.estimate_cost_and_coverage" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates number of single points (cost) and number of targets (coverage).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>self</strong> – Class instance from which the total charge and number of sites is determined.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>number of single points, number of targets.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple of ints</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="apdft.physics.APDFT.get_density_derivative">
<code class="sig-name descname">get_density_derivative</code><span class="sig-paren">(</span><em class="sig-param">sites</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/physics.html#APDFT.get_density_derivative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.physics.APDFT.get_density_derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the n-th order density derivative.</p>
<p>Heavy function, will be called often, caching needed.
The order of the derivative is implicitly known since it’s the length of <em>sites</em> argument via the chain rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sites</strong> – Integer list of sites that are perturbed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array of electron density at the grid coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="apdft.physics.APDFT.get_density_from_reference">
<code class="sig-name descname">get_density_from_reference</code><span class="sig-paren">(</span><em class="sig-param">nuclear_charges</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/physics.html#APDFT.get_density_from_reference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.physics.APDFT.get_density_from_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>Retreives the density from a QM reference. Abstract function.</p>
<p>Light function, will not be called often, so no caching needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nuclear_charges</strong> – Integer list of nuclear charges. [e]</p></li>
<li><p><strong>gridcoords</strong> – Grid coordinates. [Angstrom]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A numpy array of electron density at the grid coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="apdft.physics.APDFT.get_energy_from_reference">
<code class="sig-name descname">get_energy_from_reference</code><span class="sig-paren">(</span><em class="sig-param">nuclear_charges</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/physics.html#APDFT.get_energy_from_reference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.physics.APDFT.get_energy_from_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>Retreives the total energy from a QM reference. Abstract function.</p>
<p>Light function, will not be called often, so no caching needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nuclear_charges</strong> – Integer list of nuclear charges. [e]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The total energy. [Hartree]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="apdft.physics.APDFT.predict_all_targets">
<code class="sig-name descname">predict_all_targets</code><span class="sig-paren">(</span><em class="sig-param">do_energies=True</em>, <em class="sig-param">do_dipoles=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/physics.html#APDFT.predict_all_targets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.physics.APDFT.predict_all_targets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="apdft.physics.APDFT.update_grid">
<code class="sig-name descname">update_grid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/physics.html#APDFT.update_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.physics.APDFT.update_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures that the current integration grid is initialised.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="apdft.physics.Coulomb">
<em class="property">class </em><code class="sig-prename descclassname">apdft.physics.</code><code class="sig-name descname">Coulomb</code><a class="reference internal" href="_modules/apdft/physics.html#Coulomb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.physics.Coulomb" title="Permalink to this definition">¶</a></dt>
<dd><p>Collects functions for Coulomb interaction.</p>
<dl class="method">
<dt id="apdft.physics.Coulomb.nuclei_nuclei">
<em class="property">static </em><code class="sig-name descname">nuclei_nuclei</code><span class="sig-paren">(</span><em class="sig-param">coordinates</em>, <em class="sig-param">charges</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/physics.html#Coulomb.nuclei_nuclei"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.physics.Coulomb.nuclei_nuclei" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the nuclear-nuclear interaction energy from Coulomb interaction.</p>
<p>Sign convention assumes positive charges for nuclei.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coordinates</strong> – A (3,N) array of nuclear coordinates <span class="math notranslate nohighlight">\(\mathbf{r_i}\)</span>. [Angstrom]</p></li>
<li><p><strong>charges</strong> – A N array of point charges <span class="math notranslate nohighlight">\(q_i\)</span>. [e]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Coulombic interaction energy. [Hartree]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="apdft.physics.Dipoles">
<em class="property">class </em><code class="sig-prename descclassname">apdft.physics.</code><code class="sig-name descname">Dipoles</code><a class="reference internal" href="_modules/apdft/physics.html#Dipoles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.physics.Dipoles" title="Permalink to this definition">¶</a></dt>
<dd><p>Collects functions regarding the calculation of dipole moments. This code follows the physics convention of the sign: the dipole moment vector points from the negative charge center to the positive charge center.</p>
<dl class="method">
<dt id="apdft.physics.Dipoles.electron_density">
<em class="property">static </em><code class="sig-name descname">electron_density</code><span class="sig-paren">(</span><em class="sig-param">reference_point</em>, <em class="sig-param">coordinates</em>, <em class="sig-param">electron_density</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/physics.html#Dipoles.electron_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.physics.Dipoles.electron_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the dipole moment of a charge distribution.</p>
<p>Note that for a charge density, the resulting dipole momennt depends on the chosen reference point. A common choice in the molecular context is the center of mass.
Electron density is a positive quantity.</p>
<div class="math notranslate nohighlight">
\[\mathbf{p}(\mathbf{r}) = \int_\Omega \rho(\mathbf{r_i})(\mathbf{r_i}-\mathbf{r})\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference_point</strong> – A 3 array of the reference point <span class="math notranslate nohighlight">\(\mathbf{r}\)</span>. [Angstrom]</p></li>
<li><p><strong>coordinates</strong> – A (3,N) array of grid coordinates <span class="math notranslate nohighlight">\(\mathbf{r_i}\)</span>. [Angstrom]</p></li>
<li><p><strong>electron_density</strong> – A N array of electron density values <span class="math notranslate nohighlight">\(\rho\)</span> at <cite>coordinates</cite>. [e/Angstrom^3]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dipole moment <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>. [Debye]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="apdft.physics.Dipoles.point_charges">
<em class="property">static </em><code class="sig-name descname">point_charges</code><span class="sig-paren">(</span><em class="sig-param">reference_point</em>, <em class="sig-param">coordinates</em>, <em class="sig-param">charges</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/physics.html#Dipoles.point_charges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.physics.Dipoles.point_charges" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the dipole moment of point charges.</p>
<p>Note that for sets of point charges of a net charge, the resulting dipole moment depends on the chosen reference point. A common choice in the molecular context is the center of mass.
Sign convention is such that nuclei should be given as positive charges.</p>
<div class="math notranslate nohighlight">
\[\mathbf{p}(\mathbf{r}) = \sum_I q_i(\mathbf{r_i}-\mathbf{r})\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference_point</strong> – A 3 array of the reference point <span class="math notranslate nohighlight">\(\mathbf{r}\)</span>. [Angstrom]</p></li>
<li><p><strong>coordinates</strong> – A (3,N) array of point charge coordinates <span class="math notranslate nohighlight">\(\mathbf{r_i}\)</span>. [Angstrom]</p></li>
<li><p><strong>charges</strong> – A N array of point charges <span class="math notranslate nohighlight">\(q_i\)</span>. [e]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dipole moment <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>. [Debye]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="data">
<dt id="apdft.physics.angstrom">
<code class="sig-prename descclassname">apdft.physics.</code><code class="sig-name descname">angstrom</code><em class="property"> = 1.8897261254578281</em><a class="headerlink" href="#apdft.physics.angstrom" title="Permalink to this definition">¶</a></dt>
<dd><p>Conversion factor from Bohr in Angstrom.</p>
</dd></dl>

<dl class="function">
<dt id="apdft.physics.charge_to_label">
<code class="sig-prename descclassname">apdft.physics.</code><code class="sig-name descname">charge_to_label</code><span class="sig-paren">(</span><em class="sig-param">Z</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/physics.html#charge_to_label"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.physics.charge_to_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a nuclear charge to an element label.</p>
<p>Uncharged (ghost) sites are assigned a dash.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Nuclear charge.</strong><strong> [</strong><strong>e</strong><strong>]</strong> (<em>Z</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Element label. [String]</p>
</dd>
</dl>
</dd></dl>

<dl class="data">
<dt id="apdft.physics.debye">
<code class="sig-prename descclassname">apdft.physics.</code><code class="sig-name descname">debye</code><em class="property"> = 4.803204775077208</em><a class="headerlink" href="#apdft.physics.debye" title="Permalink to this definition">¶</a></dt>
<dd><p>Conversion factor from electron charges and Angstrom to Debye</p>
</dd></dl>

</div>
<div class="section" id="module-apdft.math">
<span id="math-related-functions"></span><h2>Math-related functions<a class="headerlink" href="#module-apdft.math" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="apdft.math.IntegerPartitions">
<em class="property">class </em><code class="sig-prename descclassname">apdft.math.</code><code class="sig-name descname">IntegerPartitions</code><a class="reference internal" href="_modules/apdft/math.html#IntegerPartitions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.math.IntegerPartitions" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="apdft.math.IntegerPartitions.partition">
<em class="property">static </em><code class="sig-name descname">partition</code><span class="sig-paren">(</span><em class="sig-param">total</em>, <em class="sig-param">maxelements</em>, <em class="sig-param">around=None</em>, <em class="sig-param">maxdz=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/math.html#IntegerPartitions.partition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.math.IntegerPartitions.partition" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds all integer partitions of <em>total</em> split into <em>maxelements</em> parts.</p>
<p>Note that ordering matters, i.e. (2, 1) and (1, 2) are district partitions. Moreover, elements of zero value are allowed. In all cases, the sum of all elements is equal to <em>total</em>.
There is no guarantee as for the ordering of elements.</p>
<p>If a center <em>around</em> is given, then a radius <em>maxdz</em> is required.
Only those partitions are listed where the L1 norm of the distance between partition and <em>around</em> is less or equal to <em>maxdz</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>total</strong> – The sum of all entries. [Integer]</p></li>
<li><p><strong>maxelements</strong> – The number of elements to split into. [Integer]</p></li>
<li><p><strong>around</strong> – Iterable of N entries. Center around which partitions are listed. [Integer]</p></li>
<li><p><strong>maxdz</strong> – Maximum absolute difference in Z space from center <em>around</em>. [Integer]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of all partitions as lists.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-apdft">
<span id="apdft-logic"></span><h2>APDFT logic<a class="headerlink" href="#module-apdft" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="apdft.get_element_number">
<code class="sig-prename descclassname">apdft.</code><code class="sig-name descname">get_element_number</code><span class="sig-paren">(</span><em class="sig-param">element</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft.html#get_element_number"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.get_element_number" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="apdft.get_methods">
<code class="sig-prename descclassname">apdft.</code><code class="sig-name descname">get_methods</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft.html#get_methods"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.get_methods" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="apdft.read_xyz">
<code class="sig-prename descclassname">apdft.</code><code class="sig-name descname">read_xyz</code><span class="sig-paren">(</span><em class="sig-param">fn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft.html#read_xyz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.read_xyz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-apdft.commandline">
<span id="command-line-interface"></span><h2>Command Line Interface<a class="headerlink" href="#module-apdft.commandline" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="apdft.commandline.build_main_commandline">
<code class="sig-prename descclassname">apdft.commandline.</code><code class="sig-name descname">build_main_commandline</code><span class="sig-paren">(</span><em class="sig-param">set_defaults=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/commandline.html#build_main_commandline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.commandline.build_main_commandline" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds an argparse object of the user-facing command line interface.</p>
</dd></dl>

<dl class="function">
<dt id="apdft.commandline.mode_energies">
<code class="sig-prename descclassname">apdft.commandline.</code><code class="sig-name descname">mode_energies</code><span class="sig-paren">(</span><em class="sig-param">conf</em>, <em class="sig-param">modeshort=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/commandline.html#mode_energies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.commandline.mode_energies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="apdft.commandline.parse_into">
<code class="sig-prename descclassname">apdft.commandline.</code><code class="sig-name descname">parse_into</code><span class="sig-paren">(</span><em class="sig-param">parser</em>, <em class="sig-param">configuration=None</em>, <em class="sig-param">cliargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/commandline.html#parse_into"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.commandline.parse_into" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the configuration with the values specified on the command line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parser</strong> – An argparse parser instance.</p></li>
<li><p><strong>configuration</strong> – A <a class="reference internal" href="#apdft.settings.Configuration" title="apdft.settings.Configuration"><code class="xref py py-class docutils literal notranslate"><span class="pre">apdft.settings.Configuration</span></code></a> instance. If <cite>None</cite>, a new instance will be returned.</p></li>
<li><p><strong>args</strong> – List of split arguments from the command line.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Mode of operation, single optional argument, updated configuration.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-apdft.settings">
<span id="settings"></span><h2>Settings<a class="headerlink" href="#module-apdft.settings" title="Permalink to this headline">¶</a></h2>
<p>Manages settings and config file parsing.</p>
<dl class="class">
<dt id="apdft.settings.CodeEnum">
<em class="property">class </em><code class="sig-prename descclassname">apdft.settings.</code><code class="sig-name descname">CodeEnum</code><a class="reference internal" href="_modules/apdft/settings.html#CodeEnum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.settings.CodeEnum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>An enumeration.</p>
<dl class="attribute">
<dt id="apdft.settings.CodeEnum.G09">
<code class="sig-name descname">G09</code><em class="property"> = 'G09'</em><a class="headerlink" href="#apdft.settings.CodeEnum.G09" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="apdft.settings.CodeEnum.MRCC">
<code class="sig-name descname">MRCC</code><em class="property"> = 'MRCC'</em><a class="headerlink" href="#apdft.settings.CodeEnum.MRCC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="apdft.settings.CodeEnum.PYSCF">
<code class="sig-name descname">PYSCF</code><em class="property"> = 'PYSCF'</em><a class="headerlink" href="#apdft.settings.CodeEnum.PYSCF" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="apdft.settings.CodeEnum.get_calculator_class">
<code class="sig-name descname">get_calculator_class</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/settings.html#CodeEnum.get_calculator_class"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.settings.CodeEnum.get_calculator_class" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="apdft.settings.Configuration">
<em class="property">class </em><code class="sig-prename descclassname">apdft.settings.</code><code class="sig-name descname">Configuration</code><a class="reference internal" href="_modules/apdft/settings.html#Configuration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.settings.Configuration" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A complete set of configuration values. Merges settings and default values.</p>
<p>Settings are referred to as category.variablename.</p>
<dl class="method">
<dt id="apdft.settings.Configuration.from_file">
<code class="sig-name descname">from_file</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/settings.html#Configuration.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.settings.Configuration.from_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="apdft.settings.Configuration.list_options">
<code class="sig-name descname">list_options</code><span class="sig-paren">(</span><em class="sig-param">section=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/settings.html#Configuration.list_options"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.settings.Configuration.list_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives all configurable options for a given section.</p>
</dd></dl>

<dl class="method">
<dt id="apdft.settings.Configuration.list_sections">
<code class="sig-name descname">list_sections</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/settings.html#Configuration.list_sections"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.settings.Configuration.list_sections" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all sections.</p>
</dd></dl>

<dl class="method">
<dt id="apdft.settings.Configuration.to_file">
<code class="sig-name descname">to_file</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/settings.html#Configuration.to_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.settings.Configuration.to_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="apdft.settings.Option">
<em class="property">class </em><code class="sig-prename descclassname">apdft.settings.</code><code class="sig-name descname">Option</code><span class="sig-paren">(</span><em class="sig-param">category</em>, <em class="sig-param">name</em>, <em class="sig-param">validator</em>, <em class="sig-param">default</em>, <em class="sig-param">description</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/settings.html#Option"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.settings.Option" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents a single configuration option.</p>
<dl class="method">
<dt id="apdft.settings.Option.get_attribute_name">
<code class="sig-name descname">get_attribute_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/settings.html#Option.get_attribute_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.settings.Option.get_attribute_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="apdft.settings.Option.get_description">
<code class="sig-name descname">get_description</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/settings.html#Option.get_description"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.settings.Option.get_description" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="apdft.settings.Option.get_validator">
<code class="sig-name descname">get_validator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/settings.html#Option.get_validator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.settings.Option.get_validator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="apdft.settings.Option.get_value">
<code class="sig-name descname">get_value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/settings.html#Option.get_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.settings.Option.get_value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="apdft.settings.Option.set_value">
<code class="sig-name descname">set_value</code><span class="sig-paren">(</span><em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/settings.html#Option.set_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.settings.Option.set_value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="apdft.settings.boolean">
<code class="sig-prename descclassname">apdft.settings.</code><code class="sig-name descname">boolean</code><span class="sig-paren">(</span><em class="sig-param">val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/settings.html#boolean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.settings.boolean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="apdft.settings.intelementrange">
<code class="sig-prename descclassname">apdft.settings.</code><code class="sig-name descname">intelementrange</code><span class="sig-paren">(</span><em class="sig-param">val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apdft/settings.html#intelementrange"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#apdft.settings.intelementrange" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="features.html" class="btn btn-neutral float-left" title="Features and supported software" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Guido Falk von Rudorff

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>